% Options for packages loaded elsewhere
\PassOptionsToPackage{unicode}{hyperref}
\PassOptionsToPackage{hyphens}{url}
%
\documentclass[
]{article}
\usepackage{lmodern}
\usepackage{amssymb,amsmath}
\usepackage{ifxetex,ifluatex}
\ifnum 0\ifxetex 1\fi\ifluatex 1\fi=0 % if pdftex
  \usepackage[T1]{fontenc}
  \usepackage[utf8]{inputenc}
  \usepackage{textcomp} % provide euro and other symbols
\else % if luatex or xetex
  \usepackage{unicode-math}
  \defaultfontfeatures{Scale=MatchLowercase}
  \defaultfontfeatures[\rmfamily]{Ligatures=TeX,Scale=1}
\fi
% Use upquote if available, for straight quotes in verbatim environments
\IfFileExists{upquote.sty}{\usepackage{upquote}}{}
\IfFileExists{microtype.sty}{% use microtype if available
  \usepackage[]{microtype}
  \UseMicrotypeSet[protrusion]{basicmath} % disable protrusion for tt fonts
}{}
\makeatletter
\@ifundefined{KOMAClassName}{% if non-KOMA class
  \IfFileExists{parskip.sty}{%
    \usepackage{parskip}
  }{% else
    \setlength{\parindent}{0pt}
    \setlength{\parskip}{6pt plus 2pt minus 1pt}}
}{% if KOMA class
  \KOMAoptions{parskip=half}}
\makeatother
\usepackage{xcolor}
\IfFileExists{xurl.sty}{\usepackage{xurl}}{} % add URL line breaks if available
\IfFileExists{bookmark.sty}{\usepackage{bookmark}}{\usepackage{hyperref}}
\hypersetup{
  pdftitle={Handout 4},
  hidelinks,
  pdfcreator={LaTeX via pandoc}}
\urlstyle{same} % disable monospaced font for URLs
\usepackage[margin=1in]{geometry}
\usepackage{color}
\usepackage{fancyvrb}
\newcommand{\VerbBar}{|}
\newcommand{\VERB}{\Verb[commandchars=\\\{\}]}
\DefineVerbatimEnvironment{Highlighting}{Verbatim}{commandchars=\\\{\}}
% Add ',fontsize=\small' for more characters per line
\usepackage{framed}
\definecolor{shadecolor}{RGB}{248,248,248}
\newenvironment{Shaded}{\begin{snugshade}}{\end{snugshade}}
\newcommand{\AlertTok}[1]{\textcolor[rgb]{0.94,0.16,0.16}{#1}}
\newcommand{\AnnotationTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\newcommand{\AttributeTok}[1]{\textcolor[rgb]{0.77,0.63,0.00}{#1}}
\newcommand{\BaseNTok}[1]{\textcolor[rgb]{0.00,0.00,0.81}{#1}}
\newcommand{\BuiltInTok}[1]{#1}
\newcommand{\CharTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{#1}}
\newcommand{\CommentTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textit{#1}}}
\newcommand{\CommentVarTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\newcommand{\ConstantTok}[1]{\textcolor[rgb]{0.00,0.00,0.00}{#1}}
\newcommand{\ControlFlowTok}[1]{\textcolor[rgb]{0.13,0.29,0.53}{\textbf{#1}}}
\newcommand{\DataTypeTok}[1]{\textcolor[rgb]{0.13,0.29,0.53}{#1}}
\newcommand{\DecValTok}[1]{\textcolor[rgb]{0.00,0.00,0.81}{#1}}
\newcommand{\DocumentationTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\newcommand{\ErrorTok}[1]{\textcolor[rgb]{0.64,0.00,0.00}{\textbf{#1}}}
\newcommand{\ExtensionTok}[1]{#1}
\newcommand{\FloatTok}[1]{\textcolor[rgb]{0.00,0.00,0.81}{#1}}
\newcommand{\FunctionTok}[1]{\textcolor[rgb]{0.00,0.00,0.00}{#1}}
\newcommand{\ImportTok}[1]{#1}
\newcommand{\InformationTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\newcommand{\KeywordTok}[1]{\textcolor[rgb]{0.13,0.29,0.53}{\textbf{#1}}}
\newcommand{\NormalTok}[1]{#1}
\newcommand{\OperatorTok}[1]{\textcolor[rgb]{0.81,0.36,0.00}{\textbf{#1}}}
\newcommand{\OtherTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{#1}}
\newcommand{\PreprocessorTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textit{#1}}}
\newcommand{\RegionMarkerTok}[1]{#1}
\newcommand{\SpecialCharTok}[1]{\textcolor[rgb]{0.00,0.00,0.00}{#1}}
\newcommand{\SpecialStringTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{#1}}
\newcommand{\StringTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{#1}}
\newcommand{\VariableTok}[1]{\textcolor[rgb]{0.00,0.00,0.00}{#1}}
\newcommand{\VerbatimStringTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{#1}}
\newcommand{\WarningTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\usepackage{graphicx}
\makeatletter
\def\maxwidth{\ifdim\Gin@nat@width>\linewidth\linewidth\else\Gin@nat@width\fi}
\def\maxheight{\ifdim\Gin@nat@height>\textheight\textheight\else\Gin@nat@height\fi}
\makeatother
% Scale images if necessary, so that they will not overflow the page
% margins by default, and it is still possible to overwrite the defaults
% using explicit options in \includegraphics[width, height, ...]{}
\setkeys{Gin}{width=\maxwidth,height=\maxheight,keepaspectratio}
% Set default figure placement to htbp
\makeatletter
\def\fps@figure{htbp}
\makeatother
\setlength{\emergencystretch}{3em} % prevent overfull lines
\providecommand{\tightlist}{%
  \setlength{\itemsep}{0pt}\setlength{\parskip}{0pt}}
\setcounter{secnumdepth}{-\maxdimen} % remove section numbering
\usepackage{booktabs}
\usepackage{longtable}
\usepackage{array}
\usepackage{multirow}
\usepackage{wrapfig}
\usepackage{float}
\usepackage{colortbl}
\usepackage{pdflscape}
\usepackage{tabu}
\usepackage{threeparttable}
\usepackage{threeparttablex}
\usepackage[normalem]{ulem}
\usepackage{makecell}
\usepackage{xcolor}

\title{Handout 4}
\author{}
\date{\vspace{-2.5em}}

\begin{document}
\maketitle

\textbf{1) Generate an undirected random graph using the model of
``preferential attachment'' (sample\_pa( )) of 1000 nodes. With
\(\beta=0.1\), \(\gamma=0.1\), generate a SIR pandemic (iterative
method). The initial infected nodes should be the 10 highest using the
eigen\_centrality( ). Compare the results to when the initial nodes are
at random. Reduce or increase \(\beta\) and compare. }

Se define el algoritmo del modelo SIR como se muestra a continuación:

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{SIR\_Model =}\StringTok{ }\ControlFlowTok{function}\NormalTok{(x, r, s, beta, gamma)\{}

\NormalTok{  R =}\StringTok{ }\NormalTok{r }\OperatorTok{+}\StringTok{ }\NormalTok{gamma }\OperatorTok{*}\StringTok{ }\NormalTok{x}
\NormalTok{  X =}\StringTok{ }\NormalTok{x }\OperatorTok{+}\StringTok{ }\NormalTok{beta }\OperatorTok{*}\StringTok{ }\NormalTok{s }\OperatorTok{*}\StringTok{ }\NormalTok{(A }\OperatorTok{\%*\%}\StringTok{ }\NormalTok{x) }\OperatorTok{{-}}\StringTok{ }\NormalTok{gamma }\OperatorTok{*}\StringTok{ }\NormalTok{x}
\NormalTok{  S =}\StringTok{ }\NormalTok{I }\OperatorTok{{-}}\StringTok{ }\NormalTok{X }\OperatorTok{{-}}\StringTok{ }\NormalTok{R}

  \KeywordTok{return}\NormalTok{(}\KeywordTok{list}\NormalTok{(S, R, X))}
\NormalTok{\}}
\end{Highlighting}
\end{Shaded}

Se ejecuta el algoritmo SIR con un grafo aleatorio de 1000 vértices y
los nodos infectados como los más 10 nodos más centrales según
``\emph{eigen\_centrality()}''. El algoritmo se ejecuta 150 iteraciones
en total:

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\#Generate random graph and obtain initial infected nodes}
\NormalTok{n =}\StringTok{ }\DecValTok{1000}
\KeywordTok{set.seed}\NormalTok{(}\DecValTok{1234}\NormalTok{)}
\NormalTok{g =}\StringTok{ }\KeywordTok{sample\_pa}\NormalTok{(n, }\DataTypeTok{power=}\DecValTok{1}\NormalTok{, }\DataTypeTok{directed=}\OtherTok{FALSE}\NormalTok{)}
\NormalTok{eigen\_cent =}\StringTok{ }\KeywordTok{order}\NormalTok{(}\KeywordTok{eigen\_centrality}\NormalTok{(g)}\OperatorTok{$}\NormalTok{vector, }\DataTypeTok{decreasing =} \OtherTok{TRUE}\NormalTok{)}
\NormalTok{infected\_n =}\StringTok{ }\KeywordTok{head}\NormalTok{(eigen\_cent, }\DecValTok{10}\NormalTok{)}

\CommentTok{\#Iteration 1 vector}
\NormalTok{x0 =}\StringTok{ }\KeywordTok{rep}\NormalTok{(}\DecValTok{0}\NormalTok{, n)}
\NormalTok{x0[infected\_n] =}\StringTok{ }\DecValTok{1}

\CommentTok{\#Initial values}
\NormalTok{beta =}\StringTok{ }\FloatTok{0.1}
\NormalTok{gamma =}\StringTok{ }\FloatTok{0.1}
\NormalTok{A =}\StringTok{ }\KeywordTok{as.matrix}\NormalTok{(}\KeywordTok{as\_adjacency\_matrix}\NormalTok{(g))}
\NormalTok{I =}\StringTok{ }\KeywordTok{rep}\NormalTok{(}\DecValTok{1}\NormalTok{, n)}
\NormalTok{R =}\StringTok{ }\KeywordTok{rep}\NormalTok{(}\DecValTok{0}\NormalTok{, n)}
\NormalTok{iter =}\StringTok{ }\DecValTok{150}

\NormalTok{RX =}\StringTok{ }\KeywordTok{matrix}\NormalTok{(}\DecValTok{0}\NormalTok{, }\DataTypeTok{nrow =}\NormalTok{ n, }\DataTypeTok{ncol =}\NormalTok{ iter)}
\NormalTok{RX[,}\DecValTok{1}\NormalTok{] =}\StringTok{ }\NormalTok{x0}

\NormalTok{RR =}\StringTok{ }\KeywordTok{matrix}\NormalTok{(}\DecValTok{0}\NormalTok{, }\DataTypeTok{nrow =}\NormalTok{ n, }\DataTypeTok{ncol =}\NormalTok{ iter)}
\NormalTok{RR[,}\DecValTok{1}\NormalTok{] =}\StringTok{ }\NormalTok{R}

\NormalTok{RS =}\StringTok{ }\KeywordTok{matrix}\NormalTok{(}\DecValTok{0}\NormalTok{, }\DataTypeTok{nrow =}\NormalTok{ n, }\DataTypeTok{ncol =}\NormalTok{ iter)}
\NormalTok{RS[,}\DecValTok{1}\NormalTok{] =}\StringTok{ }\NormalTok{I }\OperatorTok{{-}}\StringTok{ }\NormalTok{x0 }\OperatorTok{{-}}\StringTok{ }\NormalTok{R }

\CommentTok{\#SIR model, 150 iterations}
\ControlFlowTok{for}\NormalTok{ (i }\ControlFlowTok{in} \DecValTok{2}\OperatorTok{:}\NormalTok{(iter))\{}
\NormalTok{  result =}\StringTok{ }\KeywordTok{SIR\_Model}\NormalTok{(RX[,i}\DecValTok{{-}1}\NormalTok{], RR[,i}\DecValTok{{-}1}\NormalTok{], RS[,i}\DecValTok{{-}1}\NormalTok{], beta, gamma)}
  \CommentTok{\#Prob. infected}
\NormalTok{  RX[,i] =}\StringTok{ }\NormalTok{result[[}\DecValTok{3}\NormalTok{]]}
  \CommentTok{\#Prob. recovered}
\NormalTok{  RR[,i] =}\StringTok{ }\NormalTok{result[[}\DecValTok{2}\NormalTok{]]}
  \CommentTok{\#Prob. sus}
\NormalTok{  RS[,i] =}\StringTok{ }\NormalTok{result[[}\DecValTok{1}\NormalTok{]]}
\NormalTok{\}}
\end{Highlighting}
\end{Shaded}

A continuación se realiza el experimento donde los 10 nodos infectados
iniciales son escogidos aleatoriamente:

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{set.seed}\NormalTok{(}\DecValTok{1234}\NormalTok{)}
\NormalTok{infected\_n2 =}\StringTok{ }\KeywordTok{sample}\NormalTok{(}\KeywordTok{V}\NormalTok{(g), }\DecValTok{10}\NormalTok{)}
\CommentTok{\#Iteration 1 vector}
\NormalTok{x0\_Random =}\StringTok{ }\KeywordTok{rep}\NormalTok{(}\DecValTok{0}\NormalTok{, n)}
\NormalTok{x0\_Random[infected\_n2] =}\StringTok{ }\DecValTok{1}

\NormalTok{RX\_Random =}\StringTok{ }\KeywordTok{matrix}\NormalTok{(}\DecValTok{0}\NormalTok{, }\DataTypeTok{nrow =}\NormalTok{ n, }\DataTypeTok{ncol =}\NormalTok{ iter)}
\NormalTok{RX\_Random[,}\DecValTok{1}\NormalTok{] =}\StringTok{ }\NormalTok{x0\_Random}

\NormalTok{RR\_Random =}\StringTok{ }\KeywordTok{matrix}\NormalTok{(}\DecValTok{0}\NormalTok{, }\DataTypeTok{nrow =}\NormalTok{ n, }\DataTypeTok{ncol =}\NormalTok{ iter)}
\NormalTok{RR\_Random[,}\DecValTok{1}\NormalTok{] =}\StringTok{ }\NormalTok{R}

\NormalTok{RS\_Random =}\StringTok{ }\KeywordTok{matrix}\NormalTok{(}\DecValTok{0}\NormalTok{, }\DataTypeTok{nrow =}\NormalTok{ n, }\DataTypeTok{ncol =}\NormalTok{ iter)}
\NormalTok{RS\_Random[,}\DecValTok{1}\NormalTok{] =}\StringTok{ }\NormalTok{I }\OperatorTok{{-}}\StringTok{ }\NormalTok{x0 }\OperatorTok{{-}}\StringTok{ }\NormalTok{R }

\CommentTok{\#SIR model, 150 iterations}
\ControlFlowTok{for}\NormalTok{ (i }\ControlFlowTok{in} \DecValTok{2}\OperatorTok{:}\NormalTok{(iter))\{}
\NormalTok{  result\_Random =}\StringTok{ }\KeywordTok{SIR\_Model}\NormalTok{(RX\_Random[,i}\DecValTok{{-}1}\NormalTok{], RR\_Random[,i}\DecValTok{{-}1}\NormalTok{], RS\_Random[,i}\DecValTok{{-}1}\NormalTok{], beta, gamma)}
  \CommentTok{\#Prob. infected}
\NormalTok{  RX\_Random[,i] =}\StringTok{ }\NormalTok{result\_Random[[}\DecValTok{3}\NormalTok{]]}
  \CommentTok{\#Prob. recovered}
\NormalTok{  RR\_Random[,i] =}\StringTok{ }\NormalTok{result\_Random[[}\DecValTok{2}\NormalTok{]]}
  \CommentTok{\#Prob. sus}
\NormalTok{  RS\_Random[,i] =}\StringTok{ }\NormalTok{result\_Random[[}\DecValTok{1}\NormalTok{]]}
\NormalTok{\}}
\end{Highlighting}
\end{Shaded}

Comparamos los resultados de ambas ejecuciones:

\begin{table}[!h]

\caption{\label{tab:unnamed-chunk-4}Source infection: highly central nodes}
\centering
\fontsize{7}{9}\selectfont
\begin{tabular}[t]{rrrrrrrrrr}
\toprule
V1 & V2 & V3 & V4 & V5 & V6 & V7 & V8 & V9 & V10\\
\midrule
0 & 0.1 & 0.171 & 0.234162 & 0.2971629 & 0.3616584 & 0.4256001 & 0.4842934 & 0.5316024 & 0.5617739\\
0 & 0.0 & 0.010 & 0.025929 & 0.0472894 & 0.0747400 & 0.1091027 & 0.1508122 & 0.1995232 & 0.2538595\\
1 & 0.9 & 0.810 & 0.729000 & 0.6561000 & 0.5904900 & 0.5314410 & 0.4782969 & 0.4304672 & 0.3874205\\
0 & 0.0 & 0.000 & 0.001000 & 0.0034903 & 0.0080326 & 0.0154234 & 0.0267333 & 0.0432912 & 0.0666156\\
1 & 0.9 & 0.810 & 0.729000 & 0.6561000 & 0.5904900 & 0.5314410 & 0.4782969 & 0.4304672 & 0.3874205\\
\bottomrule
\end{tabular}
\end{table}

\begin{table}[!h]

\caption{\label{tab:unnamed-chunk-4}Source infection: random nodes}
\centering
\fontsize{7}{9}\selectfont
\begin{tabular}[t]{rrrrrrrrrr}
\toprule
V1 & V2 & V3 & V4 & V5 & V6 & V7 & V8 & V9 & V10\\
\midrule
1 & 0.9 & 0.81 & 0.729 & 0.6561000 & 0.5904900 & 0.5314410 & 0.4782969 & 0.4304672 & 0.3874205\\
0 & 0.0 & 0.00 & 0.000 & 0.0000000 & 0.0000000 & 0.0000020 & 0.0000124 & 0.0000449 & 0.0001232\\
0 & 0.0 & 0.00 & 0.000 & 0.0001000 & 0.0004390 & 0.0011795 & 0.0025115 & 0.0046643 & 0.0079219\\
0 & 0.0 & 0.00 & 0.000 & 0.0000000 & 0.0000000 & 0.0000000 & 0.0000000 & 0.0000000 & 0.0000002\\
0 & 0.0 & 0.00 & 0.002 & 0.0069413 & 0.0152368 & 0.0270038 & 0.0421433 & 0.0603482 & 0.0810899\\
\bottomrule
\end{tabular}
\end{table}

Centrándonos en los nodos inicialmente infectados, se puede observar en
la primera tabla, que si estos son nodos altamente conexos o centrales,
su nivel de recuperación no es muy bueno ya que tienen contacto con un
gran número de los otros nodos del grafo. Es decir, al estar
influenciados por más vecinos, su recuperación es más lenta con el paso
de las iteraciones. En cambio, si nos fijamos en los nodos inicialmente
infectados de la segunda tabla, los cuales son escogidos aleatoriamente,
vemos que su recuperación es continua con el paso de las iteraciones y
su nivel de infección va disminuyendo en cada una de ellas. Esto se debe
a que, al ser nodos escogidos al azar, no tiene por qué ser nodos
centrales o con una gran cantidad de vecinos, por lo que no se ven tan
influenciados por estos y es más fácil que se recupere.

Por otro lado, si nos fijamos en los nodos que no estaban contagiados
inicialmente (V1), podemos observar que en la segunda iteración de la
tabla 1 hay un mayor número de infectados que en la tabla 2. Para medir
los nuevos infectados, se ha sumado todas las infecciones de la segunda
iteración en ambos casos y se le restan 9 puntos ya que es la parte
aportada por los nodos infectados inicialmente (10x0,9), obteniendo los
siguientes resultados:

\begin{itemize}
\item
  Infección con nodos centrales: 9.2
\item
  Infección con nodos aleatorios: 1.4
\end{itemize}

Se puede apreciar claramente como en el primer caso la infección se ha
propagado a un mayor número de nodos en el grafo. Esto es debido, como
en el caso anterior, a la centralidad y conectividad de los nodos
infectados inicialmente. Ya que los más centrales tienen un mayor
alcance hacia otros nodos, la infección se propaga rápidamente.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{case1\_RR =}\StringTok{ }\KeywordTok{colSums}\NormalTok{(RR)}
\NormalTok{case1\_RX =}\StringTok{ }\KeywordTok{colSums}\NormalTok{(RX)}
\NormalTok{case1\_RS =}\StringTok{ }\KeywordTok{colSums}\NormalTok{(RS)}

\NormalTok{df =}\StringTok{ }\KeywordTok{as.data.frame}\NormalTok{(}\KeywordTok{t}\NormalTok{(}\KeywordTok{rbind}\NormalTok{(case1\_RR, case1\_RX, case1\_RS)))}

\KeywordTok{ggplot}\NormalTok{(df, }\KeywordTok{aes}\NormalTok{(}\DataTypeTok{x =} \KeywordTok{c}\NormalTok{(}\DecValTok{1}\OperatorTok{:}\NormalTok{iter))) }\OperatorTok{+}
\StringTok{  }\KeywordTok{geom\_line}\NormalTok{(}\KeywordTok{aes}\NormalTok{(}\DataTypeTok{y =}\NormalTok{ case1\_RR), }\DataTypeTok{color =} \StringTok{"green"}\NormalTok{) }\OperatorTok{+}
\StringTok{  }\KeywordTok{geom\_line}\NormalTok{(}\KeywordTok{aes}\NormalTok{(}\DataTypeTok{y =}\NormalTok{ case1\_RX), }\DataTypeTok{color =} \StringTok{"red"}\NormalTok{) }\OperatorTok{+}
\StringTok{  }\KeywordTok{geom\_line}\NormalTok{(}\KeywordTok{aes}\NormalTok{(}\DataTypeTok{y =}\NormalTok{ case1\_RS), }\DataTypeTok{color =} \StringTok{"blue"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{center}\includegraphics{Hoja4_files/figure-latex/unnamed-chunk-5-1} \end{center}

A continuación realizamos el mismo experimento cambiando el valor de
beta a \(\beta = 0.5\)

Comparamos los resultados de ambas ejecuciones:

\begin{table}[!h]

\caption{\label{tab:unnamed-chunk-8}Source infection: highly central nodes}
\centering
\fontsize{7}{9}\selectfont
\begin{tabular}[t]{rrrrrrrrrr}
\toprule
V1 & V2 & V3 & V4 & V5 & V6 & V7 & V8 & V9 & V10\\
\midrule
0 & 0.25 & 0.39375 & 0.6264727 & 0.8153284 & 0.8104367 & 0.6933373 & 0.6636000 & 0.5400733 & 0.5760713\\
0 & 0.00 & 0.06250 & 0.1485352 & 0.3056771 & 0.5145603 & 0.7082398 & 0.8012582 & 0.7525254 & 0.6667008\\
1 & 0.90 & 0.81000 & 0.7290000 & 0.6561000 & 0.5904900 & 0.5314410 & 0.4782969 & 0.4304672 & 0.3874205\\
0 & 0.00 & 0.00000 & 0.0156250 & 0.0506161 & 0.1346472 & 0.2939424 & 0.5344253 & 0.7802994 & 0.8441266\\
1 & 0.90 & 0.81000 & 0.7290000 & 0.6561000 & 0.5904900 & 0.5314410 & 0.4782969 & 0.4304672 & 0.3874205\\
\bottomrule
\end{tabular}
\end{table}

\begin{table}[!h]

\caption{\label{tab:unnamed-chunk-8}Source infection: random nodes}
\centering
\fontsize{7}{9}\selectfont
\begin{tabular}[t]{rrrrrrrrrr}
\toprule
V1 & V2 & V3 & V4 & V5 & V6 & V7 & V8 & V9 & V10\\
\midrule
1 & 0.9 & 0.81 & 0.72900 & 0.6561000 & 0.5904900 & 0.5314410 & 0.4782969 & 0.4304672 & 0.3874205\\
0 & 0.0 & 0.00 & 0.00000 & 0.0000000 & 0.0000000 & 0.0004883 & 0.0028771 & 0.0104169 & 0.0292666\\
0 & 0.0 & 0.00 & 0.00000 & 0.0039063 & 0.0161202 & 0.0447816 & 0.1027863 & 0.2052992 & 0.3552762\\
0 & 0.0 & 0.00 & 0.00000 & 0.0000000 & 0.0000000 & 0.0000000 & 0.0000000 & 0.0000305 & 0.0002425\\
0 & 0.0 & 0.00 & 0.03125 & 0.0970917 & 0.1963746 & 0.3102634 & 0.4070127 & 0.4671385 & 0.4943239\\
\bottomrule
\end{tabular}
\end{table}

Se observa que al aumentar el beta, la infección en la segunda iteración
de los nodos que se han infectado pasa de 0.1 a 0.25, por lo que la
propagación es más rápida. Al hacer uso de la métrica explicada
anteriormente obtenemos:

\begin{itemize}
\item
  Infección con nodos centrales: 23
\item
  Infección con nodos aleatorios: 3.5
\end{itemize}

Se observa claramente que en la segunda iteración la puntuación de la
infección, en relación a los valores obtenidos cuando beta era 0.1, ha
incrementado notablemente.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{case1\_RR =}\StringTok{ }\KeywordTok{colSums}\NormalTok{(RR)}
\NormalTok{case1\_RX =}\StringTok{ }\KeywordTok{colSums}\NormalTok{(RX)}
\NormalTok{case1\_RS =}\StringTok{ }\KeywordTok{colSums}\NormalTok{(RS)}

\NormalTok{df =}\StringTok{ }\KeywordTok{as.data.frame}\NormalTok{(}\KeywordTok{t}\NormalTok{(}\KeywordTok{rbind}\NormalTok{(case1\_RR, case1\_RX, case1\_RS)))}

\KeywordTok{ggplot}\NormalTok{(df, }\KeywordTok{aes}\NormalTok{(}\DataTypeTok{x =} \KeywordTok{c}\NormalTok{(}\DecValTok{1}\OperatorTok{:}\NormalTok{iter))) }\OperatorTok{+}
\StringTok{  }\KeywordTok{geom\_line}\NormalTok{(}\KeywordTok{aes}\NormalTok{(}\DataTypeTok{y =}\NormalTok{ case1\_RR), }\DataTypeTok{color =} \StringTok{"green"}\NormalTok{) }\OperatorTok{+}
\StringTok{  }\KeywordTok{geom\_line}\NormalTok{(}\KeywordTok{aes}\NormalTok{(}\DataTypeTok{y =}\NormalTok{ case1\_RX), }\DataTypeTok{color =} \StringTok{"red"}\NormalTok{) }\OperatorTok{+}
\StringTok{  }\KeywordTok{geom\_line}\NormalTok{(}\KeywordTok{aes}\NormalTok{(}\DataTypeTok{y =}\NormalTok{ case1\_RS), }\DataTypeTok{color =} \StringTok{"blue"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{center}\includegraphics{Hoja4_files/figure-latex/unnamed-chunk-9-1} \end{center}

\textbf{2)} Consider the random graph generated in the previous
exercice.

\emph{a)} Plot its degrees distribution in linear and in log-log scale.
Which is more helpful to understand this distribution?

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\#Calculate degree distribution}
\NormalTok{d\_dist =}\StringTok{ }\KeywordTok{degree\_distribution}\NormalTok{(g)}
\NormalTok{df\_dist =}\StringTok{ }\KeywordTok{data.frame}\NormalTok{(}\DecValTok{0}\OperatorTok{:}\DecValTok{40}\NormalTok{, d\_dist)}
\KeywordTok{colnames}\NormalTok{(df\_dist) =}\StringTok{ }\KeywordTok{c}\NormalTok{(}\StringTok{"Degree"}\NormalTok{, }\StringTok{"Relative Frequency"}\NormalTok{)}

\CommentTok{\#Calculate log}
\NormalTok{df\_dist}\OperatorTok{$}\StringTok{\textasciigrave{}}\DataTypeTok{Degree Log}\StringTok{\textasciigrave{}}\NormalTok{ =}\StringTok{ }\KeywordTok{log}\NormalTok{(df\_dist}\OperatorTok{$}\NormalTok{Degree, }\DecValTok{2}\NormalTok{)}
\NormalTok{df\_dist}\OperatorTok{$}\StringTok{\textasciigrave{}}\DataTypeTok{Relative Frequency Log}\StringTok{\textasciigrave{}}\NormalTok{ =}\StringTok{ }\KeywordTok{log}\NormalTok{(df\_dist}\OperatorTok{$}\StringTok{\textasciigrave{}}\DataTypeTok{Relative Frequency}\StringTok{\textasciigrave{}}\NormalTok{, }\DecValTok{2}\NormalTok{)}

\CommentTok{\#Lineal}
\KeywordTok{ggplot}\NormalTok{(df\_dist) }\OperatorTok{+}
\StringTok{  }\KeywordTok{geom\_point}\NormalTok{(}\KeywordTok{aes}\NormalTok{(}\DataTypeTok{x =}\NormalTok{ Degree, }\DataTypeTok{y =}\StringTok{\textasciigrave{}}\DataTypeTok{Relative Frequency}\StringTok{\textasciigrave{}}\NormalTok{), }\DataTypeTok{color =} \StringTok{"blue"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{center}\includegraphics{Hoja4_files/figure-latex/unnamed-chunk-10-1} \end{center}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\#Log{-}Log}
\KeywordTok{ggplot}\NormalTok{(df\_dist) }\OperatorTok{+}
\StringTok{  }\KeywordTok{geom\_point}\NormalTok{(}\KeywordTok{aes}\NormalTok{(}\DataTypeTok{x =} \StringTok{\textasciigrave{}}\DataTypeTok{Degree Log}\StringTok{\textasciigrave{}}\NormalTok{, }\DataTypeTok{y =}\StringTok{\textasciigrave{}}\DataTypeTok{Relative Frequency Log}\StringTok{\textasciigrave{}}\NormalTok{), }\DataTypeTok{color =} \StringTok{"blue"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{center}\includegraphics{Hoja4_files/figure-latex/unnamed-chunk-10-2} \end{center}

Al representar ambos gráficos observamos que, en este caso, al tener un
grafo de 1000 vértices, la representación lineal es fácil e intuitiva
para comprender que la mayoría de nodos tienen grado 1, 2 y 3. Los nodos
restantes, una minoría, están dispersos en un rango de grado más amplio,
que no sobrepasa de 40 grados.

En el caso de tener que representar un grafo más grande, cuyo rango de
grados podría ser mucho más amplio, sería más adecuado utilizar una
representación log-log.

\emph{b)} Does the degree distribution follows a Power Law? And if we
consider only the nodes with degree above 5? (or 10? or 100?)

La distribución de grados de nuestro grafo, como se ha podido observar
en los gráficos anteriores, sigue la relación matemática \emph{Power
Law}, donde a la derecha de la representación encontramos un amplio
rango de grados altos con frecuencias bajas y en la parte izquierda, se
encuentra un gran conjunto de nodos de grados menores.

Si solamente se tuviese en cuenta la distribución de nodos con grado
mayor a 5, 10 o 100, no se seguiría la relación \emph{Power Law}, ya que
no habría una gran cantidad de nodos con el mismo grado en la parte
izquierda de la representación. En nuestro ejemplo, la mayoría se
encuentran con grado 1, 2 y 3.

\emph{c)} Find the best line that approximates the degree distribution
after degree 10 (or 5?) using linear regression ( lm() ) on the log-log
plane. Don't worry, it is almost all done in the following code. Explain
in detail each line of the following code:

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{D =}\StringTok{ }\KeywordTok{degree\_distribution}\NormalTok{(g)  }\CommentTok{\#Obtenemos la distribución de grado}
\NormalTok{xx =}\StringTok{ }\KeywordTok{which}\NormalTok{(D}\OperatorTok{\textgreater{}}\DecValTok{0}\NormalTok{)[}\OperatorTok{{-}}\NormalTok{(}\DecValTok{1}\OperatorTok{:}\DecValTok{10}\NormalTok{)]  }\CommentTok{\#Eliminamos los 10 primeros valores}
\NormalTok{lyy =}\StringTok{ }\KeywordTok{log}\NormalTok{(D[xx]) }\CommentTok{\#Calculamos el logaritmo neperiano de la distribución completa del grafo}
\NormalTok{lxx =}\StringTok{ }\KeywordTok{log}\NormalTok{(xx) }\CommentTok{\#Calculamos el logaritmo neperiano de todo, menos los 10 primeros grados}
\NormalTok{LMI =}\StringTok{ }\KeywordTok{lm}\NormalTok{(lyy}\OperatorTok{\textasciitilde{}}\NormalTok{lxx)}\OperatorTok{$}\NormalTok{coefficients  }\CommentTok{\#Coeficientes}

\CommentTok{\#Representación gráfica}
\KeywordTok{plot}\NormalTok{(D, }\DataTypeTok{pch =} \DecValTok{20}\NormalTok{, }\DataTypeTok{cex =} \FloatTok{0.7}\NormalTok{, }\DataTypeTok{xlab =} \StringTok{"Degree"}\NormalTok{, }\DataTypeTok{ylab =} \StringTok{"Frequencies"}\NormalTok{, }\DataTypeTok{main =} \StringTok{"degrees"}\NormalTok{, }\DataTypeTok{log =} \StringTok{"xy"}\NormalTok{)}
\KeywordTok{points}\NormalTok{(}\KeywordTok{exp}\NormalTok{(lxx), }\KeywordTok{exp}\NormalTok{(LMI[}\DecValTok{1}\NormalTok{]}\OperatorTok{+}\NormalTok{LMI[}\DecValTok{2}\NormalTok{]}\OperatorTok{*}\NormalTok{lxx), }\DataTypeTok{col=}\StringTok{"red"}\NormalTok{, }\DataTypeTok{type=}\StringTok{"l"}\NormalTok{, }\DataTypeTok{lwd =} \DecValTok{2}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

La recta que mejor aproxima la distribución es:

log(P\_\{d\}(k)) = 12 + 12k

\emph{d)} What is the exponent of the Power Law for the degree
probabilities?

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{pl =}\StringTok{ }\KeywordTok{fit\_power\_law}\NormalTok{(df\_dist}\OperatorTok{$}\StringTok{\textasciigrave{}}\DataTypeTok{Relative Frequency}\StringTok{\textasciigrave{}}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

El exponente de \emph{Power Law} de nuestro grafo es 1.4801424.

\textbf{3)} Use the routine sample\_pa( ) to generate a rich-get-richer
(preferential attachment) graph with similar degree distribution of the
\emph{directed} facebook graph of the file
\textbf{facebook\_sample\_anon.txt}. Use the code similar to:
sample\_pa(n.GRAPH, out.seq=degree(GRAPH,mode=``out'')) Plot the degree
distribution of the generated graph (log-log). What is the exponent of
the power law of the generated graph for the in-degrees?

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\#Cargamos los datos del fichero .txt en un dataframe}
\NormalTok{dataframe =}\StringTok{ }\KeywordTok{read.table}\NormalTok{(}\StringTok{"data/facebook\_sample\_anon.txt"}\NormalTok{,}
                       \DataTypeTok{header =} \OtherTok{FALSE}\NormalTok{, }
                       \DataTypeTok{col.names =} \KeywordTok{c}\NormalTok{(}\StringTok{"nodeA"}\NormalTok{, }\StringTok{"nodeB"}\NormalTok{),}
                       \DataTypeTok{sep =} \StringTok{" "}\NormalTok{)}

\CommentTok{\#Generamos el grafo no dirigido desde los datos del dataframe}
\NormalTok{undirected\_graph =}\StringTok{ }\KeywordTok{graph\_from\_data\_frame}\NormalTok{(dataframe, }\DataTypeTok{directed=}\NormalTok{F)}

\NormalTok{g2 =}\StringTok{ }\KeywordTok{sample\_pa}\NormalTok{(}\KeywordTok{length}\NormalTok{(}\KeywordTok{V}\NormalTok{(undirected\_graph)), }\DataTypeTok{out.seq =} \KeywordTok{degree}\NormalTok{(undirected\_graph, }\DataTypeTok{mode=}\StringTok{"out"}\NormalTok{))}

\NormalTok{d\_dist =}\StringTok{ }\KeywordTok{degree\_distribution}\NormalTok{(g2)}
\NormalTok{df\_dist =}\StringTok{ }\KeywordTok{data.frame}\NormalTok{(}\DecValTok{0}\OperatorTok{:}\DecValTok{1597}\NormalTok{, d\_dist)}
\KeywordTok{colnames}\NormalTok{(df\_dist) =}\StringTok{ }\KeywordTok{c}\NormalTok{(}\StringTok{"Degree"}\NormalTok{, }\StringTok{"Relative Frequency"}\NormalTok{)}

\CommentTok{\#Calculate log}
\NormalTok{df\_dist}\OperatorTok{$}\StringTok{\textasciigrave{}}\DataTypeTok{Degree Log}\StringTok{\textasciigrave{}}\NormalTok{ =}\StringTok{ }\KeywordTok{log}\NormalTok{(df\_dist}\OperatorTok{$}\NormalTok{Degree, }\DecValTok{2}\NormalTok{)}
\NormalTok{df\_dist}\OperatorTok{$}\StringTok{\textasciigrave{}}\DataTypeTok{Relative Frequency Log}\StringTok{\textasciigrave{}}\NormalTok{ =}\StringTok{ }\KeywordTok{log}\NormalTok{(df\_dist}\OperatorTok{$}\StringTok{\textasciigrave{}}\DataTypeTok{Relative Frequency}\StringTok{\textasciigrave{}}\NormalTok{, }\DecValTok{2}\NormalTok{)}

\CommentTok{\#Log{-}Log}
\KeywordTok{ggplot}\NormalTok{(df\_dist) }\OperatorTok{+}
\StringTok{  }\KeywordTok{geom\_point}\NormalTok{(}\KeywordTok{aes}\NormalTok{(}\DataTypeTok{x =} \StringTok{\textasciigrave{}}\DataTypeTok{Degree Log}\StringTok{\textasciigrave{}}\NormalTok{, }\DataTypeTok{y =}\StringTok{\textasciigrave{}}\DataTypeTok{Relative Frequency Log}\StringTok{\textasciigrave{}}\NormalTok{), }\DataTypeTok{color =} \StringTok{"blue"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{center}\includegraphics{Hoja4_files/figure-latex/unnamed-chunk-13-1} \end{center}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\#Alpha}
\NormalTok{pl =}\StringTok{ }\KeywordTok{fit\_power\_law}\NormalTok{(df\_dist}\OperatorTok{$}\StringTok{\textasciigrave{}}\DataTypeTok{Relative Frequency}\StringTok{\textasciigrave{}}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

El exponente de \emph{Power Law} de nuestro grafo es 1.8099073.

\end{document}
